# ============================================================================
# Apache Security Configuration
# ============================================================================

# Hide Apache version
ServerTokens Prod
ServerSignature Off

# Security headers
<IfModule mod_headers.c>
    # Prevent clickjacking
    Header always set X-Frame-Options "SAMEORIGIN"
    
    # XSS protection
    Header always set X-XSS-Protection "1; mode=block"
    
    # Content type sniffing protection
    Header always set X-Content-Type-Options "nosniff"
    
    # Referrer policy
    Header always set Referrer-Policy "strict-origin-when-cross-origin"
    
    # Remove X-Powered-By header
    Header unset X-Powered-By
</IfModule>

# Disable directory browsing
Options -Indexes

# Prevent access to hidden files
<FilesMatch "^\.">
    Require all denied
</FilesMatch>

# Block access to sensitive file types
<FilesMatch "\.(json|env|htaccess|ini|log|sh|bak|lock)$">
    Require all denied
</FilesMatch>

# Block access to sensitive application directories
<DirectoryMatch "^/var/www/html/(vendor|app|bin|templates)">
    Require all denied
</DirectoryMatch>

# Alternative: Block using RedirectMatch (works in .htaccess too)
# RedirectMatch 403 ^/(vendor|app|bin|templates)/

